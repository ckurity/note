# 3389-RDP

- [Basic RDP Connection](#basic-rdp-connection)
- [nmap NSE for RDP](#nmap---script-rdp-enum-encryption-or-rdp-vuln-ms12-020-or-rdp-ntlm-info--p-3389--t4-ip)
- [Connect with known credentials/hash](#connect-with-known-credentialshash)

----------------------------------------------------

# [Basic RDP Connection](#basic-rdp-connection-1)
```sh
/v:<server>[:port]                Server hostname
/u:[[<domain>\]<user>|<user>[@<domain>]]    Username
/d:<domain>                       Domain
/p:<password>                     Password

$ xfreerdp /v:$ip /u:administrator
[10:44:23:023] [29694:29695] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[10:44:23:023] [29694:29695] [WARN][com.freerdp.crypto] - CN = Explosion
Password:

$ echo $t $d $u $p
10.10.30.226 LAB.ENTERPRISE.THM nik ToastyBoi!

$ xfreerdp /v:$t /d:$d /u:$u /p:$p
[09:50:34:257] [24621:24622] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[09:50:34:257] [24621:24622] [WARN][com.freerdp.crypto] - CN = LAB-DC.LAB.ENTERPRISE.THM
[09:50:35:471] [24621:24622] [ERROR][com.freerdp.core.transport] - BIO_read returned a system error 104: Connection reset by peer
[09:50:35:471] [24621:24622] [ERROR][com.freerdp.core] - transport_read_layer:freerdp_set_last_error_ex ERRCONNECT_CONNECT_TRANSPORT_FAILED [0x0002000D]
[09:50:38:204] [24621:24622] [ERROR][com.freerdp.core.transport] - BIO_read returned a system error 104: Connection reset by peer
[09:50:38:204] [24621:24622] [ERROR][com.freerdp.core] - transport_read_layer:freerdp_set_last_error_ex ERRCONNECT_CONNECT_TRANSPORT_FAILED [0x0002000D]
[09:50:38:204] [24621:24622] [ERROR][com.freerdp.core] - freerdp_post_connect failed


$ u=bitbucket
$ p=littleredbucket
$ echo $t $d $u $p
10.10.30.226 LAB.ENTERPRISE.THM bitbucket littleredbucket

$ xfreerdp /v:$t /d:$d /u:$u /p:$p
[09:53:31:228] [26426:26427] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[09:53:31:228] [26426:26427] [WARN][com.freerdp.crypto] - CN = LAB-DC.LAB.ENTERPRISE.THM
[09:53:35:758] [26426:26427] [ERROR][com.winpr.timezone] - Unable to find a match for unix timezone: US/Eastern
[09:53:36:664] [26426:26427] [INFO][com.freerdp.gdi] - Local framebuffer format  PIXEL_FORMAT_BGRX32
[09:53:36:665] [26426:26427] [INFO][com.freerdp.gdi] - Remote framebuffer format PIXEL_FORMAT_BGRA32
[09:53:36:723] [26426:26427] [INFO][com.freerdp.channels.rdpsnd.client] - [static] Loaded fake backend for rdpsnd
[09:53:36:723] [26426:26427] [INFO][com.freerdp.channels.drdynvc.client] - Loading Dynamic Virtual Channel rdpgfx
        
        [snip - successfull RDP attempt] 
        
```

# [nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 $ip](#nmap---script-rdp-enum-encryption-or-rdp-vuln-ms12-020-or-rdp-ntlm-info--p-3389--t4-ip-1)
```sh
$ nmap --script "rdp-enum-encryption or rdp-vuln-ms12-020 or rdp-ntlm-info" -p 3389 -T4 $ip
Nmap scan report for 10.129.74.95
Host is up (0.18s latency).

PORT     STATE SERVICE
3389/tcp open  ms-wbt-server
| rdp-ntlm-info: 
|   Target_Name: EXPLOSION
|   NetBIOS_Domain_Name: EXPLOSION
|   NetBIOS_Computer_Name: EXPLOSION
|   DNS_Domain_Name: Explosion
|   DNS_Computer_Name: Explosion
|   Product_Version: 10.0.17763
|_  System_Time: 2023-09-15T02:35:06+00:00
| rdp-enum-encryption: 
|   Security layer
|     CredSSP (NLA): SUCCESS
|     CredSSP with Early User Auth: SUCCESS
|_    RDSTLS: SUCCESS

Nmap done: 1 IP address (1 host up) scanned in 4.12 seconds
```

# [Connect with known credentials/hash](#connect-with-known-credentialshash-1)
```sh
rdesktop -u <username> <IP>
rdesktop -d <domain> -u <username> -p <password> <IP>
xfreerdp [/d:domain] /u:<username> /p:<password> /v:<IP>
xfreerdp [/d:domain] /u:<username> /pth:<hash> /v:<IP> #Pass the hash
```

### 
```

```

### 
```

```

### 
```

```

### 
```

```

### 
```

```