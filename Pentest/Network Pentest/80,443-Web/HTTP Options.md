# [Multiple Ways to Detect HTTP Options](https://www.hackingarticles.in/multiple-ways-to-detect-http-options/)

- [TLDR](#tldr)
    - [Nmap](#nmap)
    - [cURL](#curl)
    - [Metasploit](#metasploit)
        - [Example](#example)
        - [One liner start scan](#one-liner-start-scan)
    - [Nikto](#nikto)

# TLDR
```sh
nmap --script http-methods $ip -p 80,443
```

# Nmap
```sh
nmap --script http-methods --script-args http-method.test-all ='/192.168.1.109' 192.168.1.109

$ nmap --script http-methods example.com -p 80,443
Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-27 00:48 EDT
Nmap scan report for example.com (93.184.216.34)
Host is up (0.21s latency).
Other addresses for example.com (not scanned): 2606:2800:220:1:248:1893:25c8:1946

PORT    STATE SERVICE
80/tcp  open  http
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
443/tcp open  https
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST

Nmap done: 1 IP address (1 host up) scanned in 2.71 seconds
```

# cURL
```sh
curl -vX OPTIONS $ip

$ curl -4vX OPTIONS example.com
* processing: example.com
*   Trying 93.184.216.34:80...
* Connected to example.com (93.184.216.34) port 80
> OPTIONS / HTTP/1.1
> Host: example.com
> User-Agent: curl/8.2.1
> Accept: */*
> 
< HTTP/1.1 200 OK
< Allow: OPTIONS, GET, HEAD, POST
< Cache-Control: max-age=604800
< Content-Type: text/html; charset=UTF-8
< Date: Wed, 27 Sep 2023 04:49:19 GMT
< Expires: Wed, 04 Oct 2023 04:49:19 GMT
< Server: EOS (vny/044F)
< Content-Length: 0
< 
* Connection #0 to host example.com left intact
```

# Netcat
```sh
nc $ip 80

OPTIONS http://$ip / HTTP/1.0
# host:$ip

$ nc example.com 80
OPTIONS http://example.com HTTP/1.0

HTTP/1.0 200 OK
Allow: OPTIONS, GET, HEAD, POST
Cache-Control: max-age=604800
Content-Type: text/html; charset=UTF-8
Date: Wed, 27 Sep 2023 04:50:59 GMT
Expires: Wed, 04 Oct 2023 04:50:59 GMT
Server: EOS (vny/044F)
Content-Length: 0
Connection: close
```


# Metasploit
## Syntax
```sh
msfconsole
use auxiliary/scanner/http/options
set rhosts 192.168.1.109
set rport 80
run / exploit
```

### Example
```sh
msf6 auxiliary(scanner/http/options) > set rhosts example.com
rhosts => example.com
msf6 auxiliary(scanner/http/options) > set rport 80
rport => 80
msf6 auxiliary(scanner/http/options) > run 

[+] 2606:2800:220:1:248:1893:25c8:1946 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 1 of 2 hosts (50% complete)
[+] 93.184.216.34 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 2 of 2 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/http/options) > 
```

### [One liner start scan](https://github.com/andrewjkerr/security-cheatsheets/blob/master/metasploit)
-x, --execute-command COMMAND    Execute the specified console commands (use ; for multiples)
-q, --quiet                      Do not print the banner on startup
```sh
$ msfconsole -qx "use auxiliary/scanner/http/options; set rhosts example.com; set rport 80; run; exit"
rhosts => example.com
rport => 80
[+] 2606:2800:220:1:248:1893:25c8:1946 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 1 of 2 hosts (50% complete)
[+] 93.184.216.34 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 2 of 2 hosts (100% complete)
[*] Auxiliary module execution completed
```

# Burp Suite
```sh

```

# Nikto
```sh
nikto -h $ip
```




### 
```sh

```

### 
```sh

```

### 
```sh

```

### 
```sh

```
