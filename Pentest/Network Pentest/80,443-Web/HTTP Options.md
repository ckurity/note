# [Multiple Ways to Detect HTTP Options](https://www.hackingarticles.in/multiple-ways-to-detect-http-options/)

- [TLDR](#tldr)
    - [Nmap](#nmap)
    - [cURL](#curl)
    - [Metasploit](#metasploit)
        - [Example](#example)
        - [One liner start scan](#one-liner-start-scan)
    - [Nikto](#nikto)
- [Q&A](#qa)
    - [Is HTTP OPTIONS considered Insecure HTTP methods?](#is-http-options-considered-insecure-http-methods)

# TLDR
```sh
nmap --script http-methods $ip -p 80,443
```

# Nmap
```sh
nmap --script http-methods --script-args http-method.test-all ='/192.168.1.109' 192.168.1.109

$ nmap --script http-methods example.com -p 80,443
Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-27 00:48 EDT
Nmap scan report for example.com (93.184.216.34)
Host is up (0.21s latency).
Other addresses for example.com (not scanned): 2606:2800:220:1:248:1893:25c8:1946

PORT    STATE SERVICE
80/tcp  open  http
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
443/tcp open  https
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST

Nmap done: 1 IP address (1 host up) scanned in 2.71 seconds
```

# cURL
```sh
curl -vX OPTIONS $ip

$ curl -4vX OPTIONS example.com
* processing: example.com
*   Trying 93.184.216.34:80...
* Connected to example.com (93.184.216.34) port 80
> OPTIONS / HTTP/1.1
> Host: example.com
> User-Agent: curl/8.2.1
> Accept: */*
> 
< HTTP/1.1 200 OK
< Allow: OPTIONS, GET, HEAD, POST
< Cache-Control: max-age=604800
< Content-Type: text/html; charset=UTF-8
< Date: Wed, 27 Sep 2023 04:49:19 GMT
< Expires: Wed, 04 Oct 2023 04:49:19 GMT
< Server: EOS (vny/044F)
< Content-Length: 0
< 
* Connection #0 to host example.com left intact
```

# Netcat
```sh
nc $ip 80

OPTIONS http://$ip / HTTP/1.0
# host:$ip

$ nc example.com 80
OPTIONS http://example.com HTTP/1.0

HTTP/1.0 200 OK
Allow: OPTIONS, GET, HEAD, POST
Cache-Control: max-age=604800
Content-Type: text/html; charset=UTF-8
Date: Wed, 27 Sep 2023 04:50:59 GMT
Expires: Wed, 04 Oct 2023 04:50:59 GMT
Server: EOS (vny/044F)
Content-Length: 0
Connection: close
```


# Metasploit
## Syntax
```sh
msfconsole
use auxiliary/scanner/http/options
set rhosts 192.168.1.109
set rport 80
run / exploit
```

### Example
```sh
msf6 auxiliary(scanner/http/options) > set rhosts example.com
rhosts => example.com
msf6 auxiliary(scanner/http/options) > set rport 80
rport => 80
msf6 auxiliary(scanner/http/options) > run 

[+] 2606:2800:220:1:248:1893:25c8:1946 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 1 of 2 hosts (50% complete)
[+] 93.184.216.34 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 2 of 2 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/http/options) > 
```

### [One liner start scan](https://github.com/andrewjkerr/security-cheatsheets/blob/master/metasploit)
-x, --execute-command COMMAND    Execute the specified console commands (use ; for multiples)
-q, --quiet                      Do not print the banner on startup
```sh
$ msfconsole -qx "use auxiliary/scanner/http/options; set rhosts example.com; set rport 80; run; exit"
rhosts => example.com
rport => 80
[+] 2606:2800:220:1:248:1893:25c8:1946 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 1 of 2 hosts (50% complete)
[+] 93.184.216.34 allows OPTIONS, GET, HEAD, POST methods
[*] Scanned 2 of 2 hosts (100% complete)
[*] Auxiliary module execution completed
```

# Burp Suite
```sh

```

# Nikto
```sh
nikto -h $ip
```

# Q&A
## Is HTTP OPTIONS considered Insecure HTTP methods?
### ChatGPT
```sh
No, the HTTP OPTIONS method itself is not considered insecure. It is one of the standard HTTP methods defined by the HTTP/1.1 specification, and its primary purpose is to allow a client to request information about the communication options available for a target resource. This can include information about the supported HTTP methods, allowed request headers, and other communication options.

The OPTIONS method is often used for:

1.	Cross-Origin Resource Sharing (CORS): Browsers use OPTIONS requests to check if a web page from one origin is allowed to make requests to a different origin. This helps prevent cross-site request forgery (CSRF) and other security vulnerabilities.

2.	API Discovery: Some APIs use OPTIONS requests to provide information about available endpoints and supported methods.

3.	Server Configuration: It can also be used to query the server about its capabilities and configuration.

While the OPTIONS method itself is not inherently insecure, how it is implemented and configured on a server can impact security. For example, if a server responds to OPTIONS requests with sensitive information or allows unrestricted access, it can pose security risks. Therefore, it's essential to configure your server properly and handle OPTIONS requests securely to prevent information leakage or unauthorized access.

In summary, the HTTP OPTIONS method is a legitimate part of the HTTP protocol and is not inherently insecure. It serves important purposes in web development and can be used securely when implemented and configured correctly.
```

### Bard
```sh
The HTTP OPTIONS method is not considered insecure in itself, but it can be exploited by attackers to gather information about a web server and its capabilities. This information can then be used to launch more targeted attacks.

For example, an attacker could use an OPTIONS request to determine which HTTP methods are supported by a web server. This could allow the attacker to identify potential vulnerabilities, such as the ability to execute arbitrary code or upload files.

In addition, the OPTIONS method can be used to determine which headers are supported by a web server. This information could then be used to launch cross-site scripting (XSS) attacks.

For these reasons, it is generally considered good practice to disable the OPTIONS method unless it is specifically needed.

There are some cases where the OPTIONS method is required, such as for Cross-Origin Resource Sharing (CORS). If the OPTIONS method is required, it is important to implement appropriate security measures, such as authentication and authorization.

Here are some tips for mitigating the risks associated with the OPTIONS method:
•	Disable the OPTIONS method unless it is specifically needed.
•	Implement authentication and authorization for all HTTP methods, including OPTIONS.
•	Use a web application firewall (WAF) to block malicious OPTIONS requests.
•	Keep your web server and software up to date with the latest security patches.

If you are unsure whether or not the OPTIONS method is needed for your web application, it is best to consult with a security expert.
```

## If HTTP OPTIONS method found, should this be included in Pentest Report as a valid finding?

### Bard - Yes
```sh
Yes, the OPTIONS method should be included in a pentest report as a valid finding, even if it is not considered insecure in itself. This is because the OPTIONS method can be used by attackers to gather information about a web server and its capabilities, which can then be used to launch more targeted attacks.

For example, an attacker could use an OPTIONS request to determine which HTTP methods are supported by a web server. This could allow the attacker to identify potential vulnerabilities, such as the ability to execute arbitrary code or upload files.

In addition, the OPTIONS method can be used to determine which headers are supported by a web server. This information could then be used to launch cross-site scripting (XSS) attacks.

When including the OPTIONS method finding in a pentest report, it is important to provide the following information:
•	A description of the vulnerability
•	The potential impact of the vulnerability
•	Recommendations for mitigating the vulnerability

For example, you could recommend that the web application firewall (WAF) be configured to block malicious OPTIONS requests. You could also recommend that the web server be configured to disable the OPTIONS method unless it is specifically needed.

By including the OPTIONS method finding in your pentest report, you are helping the organization to be aware of the potential risks and to take steps to mitigate them.

Here are some additional tips for writing a good pentest report:
•	Be clear and concise in your writing.
•	Use technical language that is appropriate for your audience.
•	Provide specific recommendations for mitigating the vulnerabilities that you find.
•	Proofread your report carefully before submitting it.

I hope this information is helpful.
```


### ChatGPT - depends
```sh
The inclusion of the HTTP OPTIONS method in a penetration testing (pentest) report depends on the context and the specific findings related to its usage on the target application or system. Here are some considerations for including the HTTP OPTIONS method in a pentest report:

1.	Configuration Issues: If during the penetration test, you discover that the server's configuration for handling OPTIONS requests is insecure (e.g., it provides sensitive information or allows unrestricted access), then it should be documented as a finding. This could be considered a security vulnerability.

2.	CORS Issues: If the application has Cross-Origin Resource Sharing (CORS) misconfigurations related to OPTIONS requests, such as allowing overly permissive cross-origin requests, this should also be documented. Such misconfigurations can be security risks.

3.	Authentication and Authorization Bypass: In some cases, the OPTIONS method might be leveraged by an attacker to bypass authentication or authorization mechanisms. If you find such issues during the pentest, they should be reported as security vulnerabilities.

4.	Information Disclosure: If the server responds to OPTIONS requests with sensitive information that could aid an attacker (e.g., exposing internal server details), this should be reported as a security concern.

5.	Best Practices: If you identify that the server is not following best practices in handling OPTIONS requests, you can include recommendations for securing it properly, even if there are no immediate vulnerabilities.

6.	Exclusions: On the other hand, if you perform a thorough assessment and find that the HTTP OPTIONS method is configured correctly and doesn't pose any security risks, you can include this in your report as a positive finding, emphasizing that no vulnerabilities were identified related to the OPTIONS method.

In summary, whether the presence of the HTTP OPTIONS method should be included in a pentest report depends on the specific security implications you uncover during the test. It's essential to provide a clear and detailed report that helps the client understand any security issues, potential risks, and recommended mitigation measures related to the OPTIONS method or any other aspects of the tested system.
```

### 
```sh

```
