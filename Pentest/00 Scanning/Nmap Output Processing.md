# Nmap Output Processing

Nmap Output Processing Nmap Grep nmap 

# TL;DR
## Port Number Only
```sh
grep -oP '^\d+' *.nmap
```

## nmap -sV from -A with header
```sh
grep -P '^PORT|^\d+/' *nmap* |sed 's/syn-ack//' | tee 1_nmap-sV
```

## Port Number Only
```sh
grep -oP '^\d+' *.nmap
```

# nmap -sV from -A without header
```sh
grep -P '^\d+/' *.nmap |sed 's/syn-ack//' 
```

# Get the SERVICE name only (3rd column)
```sh
grep -P '^\d+/' *.nmap |sed 's/syn-ack//' |awk '{print $3}'
```

# Get the VERSION name only (last column)
```sh
grep -P '^\d+/' *.nmap |sed 's/syn-ack//' |awk '{for (i=4; i<=NF; i++) {printf $i" ";} printf "\n";}'
```

## Port Number Only
```sh
$ grep -oP '^\d+' *.nmap
21
22
139
```

## nmap -sV from -A with header
```sh
$ grep -P '^PORT|^\d+/' *.nmap |sed 's/syn-ack//'
PORT     STATE SERVICE     REASON  VERSION
21/tcp   open  ftp          vsftpd 3.0.3
22/tcp   open  ssh          OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp  open  netbios-ssn  Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
```

# nmap -sV from -A without header
```sh
$ grep -P '^\d+/' *.nmap |sed 's/syn-ack//' 
21/tcp   open  ftp          vsftpd 3.0.3
22/tcp   open  ssh          OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
139/tcp  open  netbios-ssn  Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
```

# Get the SERVICE name only (3rd column)
```sh
$ grep -P '^\d+/' *.nmap |sed 's/syn-ack//' |awk '{print $3}'
ftp
ssh
netbios-ssn
```