# Scan

- [Wordlists Selection](#wordlists-selection)
  - [Default feroxbuster wordlists, 220k](#default-feroxbuster-wordlists-220k)
- [rustscan](#rustscan)
  - [Basic Command](#basic-command)
  - [With nmap -A](#with-nmap--a)
  - [nmap -sV or grep from previous scan](#nmap--sv-or-grep-from-previous-scan)
  - [Create a new directory based on Rustscan/Nmap output](#create-a-new-directory-based-on-rustscannmap-output)
- [nuclei](#nuclei)
  - [http tcp/80](#http-tcp80)
  - [https tcp/443](#https-tcp443)
  - [Custom Port](#custom-port)
- [feroxbuster](#feroxbuster)
  - [http tcp/80](#http-tcp80-1)
  - [https tcp/443](#https-tcp443-1)
  - [https tcp/443 ignore cert](#https-tcp443-ignore-cert)
  - [Custom Port](#custom-port-1)
  - [Filter out status codes (deny list)](#filter-out-status-codes-deny-list)
- [curl](#curl)
- [lynx](#lynx)
- [nikto](#nikto)


## Wordlists Selection
```sh
/usr/share/dirb/wordlists/common.txt                                  # 4614
/usr/share/seclists/Discovery/Web-Content/big.txt                     # 20476
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt # 30000, default in feroxbuster
/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt          # 220560
```

### Default feroxbuster wordlists, 220k
```sh
feroxbuster -u http://$t -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
```

## rustscan
### Basic Command
```sh
rustscan -a $t

-a, --addresses <addresses>...     A comma-delimited list or newline-delimited file of separated CIDRs, IPs, or
                                       hosts to be scanned
```

### With nmap -A
```sh
rustscan -a $t -- -Pn -A -oN nmap-A_$(date +%y%m%d-%H%M)
```

### nmap -sV or grep from previous scan
```sh
grep -P '^PORT|^\d' nmap* | sed 's/syn-ack//'
```

### Create a new directory based on Rustscan/Nmap output
```sh
grep -oP '^\d+' *.nmap | xargs -I {} mkdir tcp-{}
```

## nuclei

### http tcp/80
```sh
nuclei -u http://$t | tee nuclei-80_$(date +%y%m%d-%H%M).txt
```

### https tcp/443
```sh
nuclei -u $t | tee nuclei-443_$(date +%y%m%d-%H%M).txt
```

### Custom Port
```sh
nuclei -u $t:$p | tee nuclei-${p}_$(date +%y%m%d-%H%M).txt
```

## feroxbuster

### http tcp/80
```sh
feroxbuster -u http://$t -C 404 -o ferox-80_$(date +%y%m%d-%H%M).txt
```

### https tcp/443
```sh
feroxbuster -u $t -C 404 -o ferox-443_$(date +%y%m%d-%H%M).txt
```

### https tcp/443 ignore cert
```sh
feroxbuster -ku $t -C 404 -o ferox-443_$(date +%y%m%d-%H%M).txt
```

### Custom Port
```
feroxbuster -u $t:$port -C 404 -o ferox-${port}_$(date +%y%m%d-%H%M).txt
```

### Filter out status codes (deny list)
-C, --filter-status <STATUS_CODE>...
      Filter out status codes (deny list) (ex: -C 200 -C 401)
```sh
feroxbuster -u http://$t -w /usr/share/dirb/wordlists/common.txt -C 404,502
```

## curl
```sh
curl -sv $t |html2text
curl -s $t |html2text |grep -v ^$
curl -s $t |sed -n '/<form /,/form>/p'
```

## lynx
```sh
lynx -dump -listonly -nonumbers $t
lynx -dump -listonly -nonumbers $t |uniq
lynx -dump -listonly -nonumbers $t |sort|uniq|nl
lynx -dump -listonly -nonumbers $t:$p
```

## nikto
```sh
nikto -h $t -o nikto_$(date +%y%m%d-%H%M).txt
```

