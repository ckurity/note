# servicePrincipalName

- [Find servicePrincipalName](#find-serviceprincipalname-1)
- [Unauthenticated](#unauthenticated)
    - [Unauthenticated ldapsearch](#unauthenticated-ldapsearch)
- [Authenticated](#authenticated)
    - [Authenticated ldapsearch](#authenticated-ldapsearch)

-------------------------------------------

# Find servicePrincipalName
> You can know that a user account is being used as a service because the property "ServicePrincipalName" is not null.
https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/kerberoast

# Unauthenticated
## Unauthenticated ldapsearch
```sh
$ ldapsearch -xH ldap://$ip -b 'DC=cascade,DC=local' > ldapsearch_basedn.txt

$ grep servicePrincipalName ldapsearch_basedn.txt  
servicePrincipalName: TERMSRV/CASC-DC1
servicePrincipalName: TERMSRV/CASC-DC1.cascade.local
servicePrincipalName: ldap/CASC-DC1.cascade.local/ForestDnsZones.cascade.local
servicePrincipalName: ldap/CASC-DC1.cascade.local/DomainDnsZones.cascade.local
servicePrincipalName: Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/CASC-DC1.casca
servicePrincipalName: DNS/CASC-DC1.cascade.local
```

# Authenticated
## Authenticated ldapsearch
```sh
ldapsearch -H ldap://$ip -b 'DC=BLACKFIELD,DC=local' -D 'support@blackfield.local' -w '#00^BlackKnight' | tee ldapsearch-support.txt

grep servicePrincipalName ldapsearch-support.txt

# Example

$ grep servicePrincipalName ldapsearch-support.txt
servicePrincipalName: Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/DC01.BLACKFIEL
servicePrincipalName: ldap/DC01.BLACKFIELD.local/ForestDnsZones.BLACKFIELD.loc
servicePrincipalName: ldap/DC01.BLACKFIELD.local/DomainDnsZones.BLACKFIELD.loc
servicePrincipalName: TERMSRV/DC01
servicePrincipalName: TERMSRV/DC01.BLACKFIELD.local
...
```


### 
```sh

```

### 
```sh

```

### 
```sh

```

### 
```sh

```

### 
```sh

```

### 
```sh

```

### 
```sh

```