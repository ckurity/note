# GenericAll (full control)

- [](#genericall-full-control)
    - [Info](#info)
        - [Targeted Kerberoast](#targeted-kerberoast)
        - [Force Change Password](#force-change-password)
    - [Create a new PowerShell credential object](#create-a-new-powershell-credential-object-using-the-new-object-cmdlet)
        - [$Cred](#cred)
        - [New-Object System.Management.Automation.PSCredential](#new-object-systemmanagementautomationpscredential)
            - [New-Object](#new-object)
            - [System.Management.Automation.PSCredential](#systemmanagementautomationpscredential)
        - [('TESTLAB\dfm.a', $SecPassword)](#testlabdfma-secpassword)
            - ['TESTLAB\dfm.a'](#testlabdfma)
            - [$SecPassword](#secpassword)
    - [Run the "whoami" cmdlet on the local computer using the credentials stored in the $Cred variable](#run-the-whoami-cmdlet-on-the-local-computer-using-the-credentials-stored-in-the-cred-variable)

## Info
Full control of a user allows you to modify properties of the user to perform a targeted kerberoast attack, and also grants the ability to reset the password of the user without knowing their current one.

### Targeted Kerberoast
### Force Change Password

## Create a new PowerShell credential object using the New-Object cmdlet
 Creates a new PSCredential object using the specified username and password. The PSCredential object can then be used to authenticate to remote computers or resources.
```PowerShell
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
```

### $Cred
```
This variable will hold the PSCredential object once it's created.
```

### New-Object System.Management.Automation.PSCredential
```
This part of the code creates a new instance of a PSCredential object.
```

### New-Object
```
PowerShell cmdlet that creates new objects.
```

### System.Management.Automation.PSCredential
```
the type of object that is being created.
```

### ('TESTLAB\dfm.a', $SecPassword)
```
the parameters that are being passed to the New-Object cmdlet.
```

### 'TESTLAB\dfm.a'
```
the username you want to associate with the credential in the format of a domain\username.
```

### $SecPassword
```
The password must be stored in a secure variable
```

### Run the "whoami" cmdlet on the local computer using the credentials stored in the $Cred variable
```
Invoke-Command -ComputerName 127.0.0.1 -Credential $Cred -ScriptBlock { whoami }
```

The Invoke-Command cmdlet in PowerShell is used to run commands on remote computers. In your example, you're trying to run the whoami command on the local computer (127.0.0.1) with the specified credentials stored in the $Cred variable. Here's how your code works: