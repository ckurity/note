- [TL;DR](#tldr)
- [Compile Instructions](#compile-instructions)
- [Find information about all registered CAs](#find-information-about-all-registered-cas)
- [Find vulnerable/abusable certificate templates using default low-privileged groups](#find-vulnerableabusable-certificate-templates-using-default-low-privileged-groups)
- [References](#references)

-------------------------------------------

## [TL;DR](#tldr)
```sh
Certify.exe find /vulnerable
```

We are not planning on releasing binaries for Certify, so you will have to compile yourself :)

Certify has been built against .NET 4.0 and is compatible with Visual Studio 2019 Community Edition. 
Simply open up the project .sln, choose "Release", and build.

https://visualstudio.microsoft.com/vs/community/

## [Compile Instructions](#compile-instructions-1)
```sh

```

## [Find information about all registered CAs](#find-information-about-all-registered-cas-1)
Certify.exe cas
```sh
lunar\thm@LUNDC C:\Users\thm>Certify.exe cas
 
   _____          _   _  __
  / ____|        | | (_)/ _|              
 | |     ___ _ __| |_ _| |_ _   _         
 | |    / _ \ '__| __| |  _| | | |       
 | |___|  __/ |  | |_| | | | |_| |        
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |        
                            |___./
  v1.1.0                                
 
[*] Action: Find certificate authorities 
[*] Using the search base 'CN=Configuration,DC=lunar,DC=eruca,DC=com' 


[*] Root CAs

    Cert SubjectName              : CN=lunar-LUNDC-CA, DC=lunar, DC=eruca, DC=com 
    Cert Thumbprint               : 1801B99A99D23D0CF06A8676A1891FDD0F16C512 
    Cert Serial                   : 77420116D46A6586476B85BD5BF6A237 
    Cert Start Date               : 1/14/2022 7:21:18 AM 
    Cert End Date                 : 1/14/2027 7:31:16 AM 
    Cert Chain                    : CN=lunar-LUNDC-CA,DC=lunar,DC=eruca,DC=com 



[*] NTAuthCertificates - Certificates that enable authentication:
 
    Cert SubjectName              : CN=lunar-LUNDC-CA, DC=lunar, DC=eruca, DC=com 
    Cert Thumbprint               : 1801B99A99D23D0CF06A8676A1891FDD0F16C512 
    Cert Serial                   : 77420116D46A6586476B85BD5BF6A237
    Cert Start Date               : 1/14/2022 7:21:18 AM
    Cert End Date                 : 1/14/2027 7:31:16 AM 
    Cert Chain                    : CN=lunar-LUNDC-CA,DC=lunar,DC=eruca,DC=com


[*] Enterprise/Enrollment CAs:

    Enterprise CA Name            : lunar-LUNDC-CA 
    DNS Hostname                  : LUNDC.lunar.eruca.com 
    FullName                      : LUNDC.lunar.eruca.com\lunar-LUNDC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED 
    Cert SubjectName              : CN=lunar-LUNDC-CA, DC=lunar, DC=eruca, DC=com
    Cert Thumbprint               : 1801B99A99D23D0CF06A8676A1891FDD0F16C512
    Cert Serial                   : 77420116D46A6586476B85BD5BF6A237 
    Cert Start Date               : 1/14/2022 7:21:18 AM
    Cert End Date                 : 1/14/2027 7:31:16 AM
    Cert Chain                    : CN=lunar-LUNDC-CA,DC=lunar,DC=eruca,DC=com
    UserSpecifiedSAN              : Disabled 
    CA Permissions                : 
      Owner: BUILTIN\Administrators        S-1-5-32-544 

      Access Rights                                     Principal
 
      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544 
      Allow  ManageCA, ManageCertificates               LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512  
      Allow  ManageCA, ManageCertificates               LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519  
    Enrollment Agent Restrictions : None

    Enabled Certificate Templates:
        HTTPSWebServer
        UserRequest
        DirectoryEmailReplication
        DomainControllerAuthentication
        KerberosAuthentication
        EFSRecovery
        EFS
        DomainController
        WebServer
        Machine
        User
        SubCA
        Administrator

Certify completed in 00:01:04.8657860
lunar\thm@LUNDC C:\Users\thm>
```

```sh
PS C:\a> .\Certify.exe cas

   _____          _   _  __
  / ____|        | | (_)/ _|
 | |     ___ _ __| |_ _| |_ _   _
 | |    / _ \ '__| __| |  _| | | |
 | |___|  __/ |  | |_| | | | |_| |
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |
                            |___./
  v1.1.0

[*] Action: Find certificate authorities
[*] Using the search base 'CN=Configuration,DC=MARVEL,DC=local'


[*] Root CAs

    Cert SubjectName              : CN=MARVEL-HYDRA-DC-CA, DC=MARVEL, DC=local
    Cert Thumbprint               : 692FE10DF2AE748DF58F574181D40FE4D4EF7819
    Cert Serial                   : 43267633E3973CB44EAAE8F936D0A7AE
    Cert Start Date               : 11/21/2023 5:51:22 AM
    Cert End Date                 : 11/21/2122 6:01:22 AM
    Cert Chain                    : CN=MARVEL-HYDRA-DC-CA,DC=MARVEL,DC=local



[*] NTAuthCertificates - Certificates that enable authentication:

    Cert SubjectName              : CN=MARVEL-HYDRA-DC-CA, DC=MARVEL, DC=local
    Cert Thumbprint               : 692FE10DF2AE748DF58F574181D40FE4D4EF7819
    Cert Serial                   : 43267633E3973CB44EAAE8F936D0A7AE
    Cert Start Date               : 11/21/2023 5:51:22 AM
    Cert End Date                 : 11/21/2122 6:01:22 AM
    Cert Chain                    : CN=MARVEL-HYDRA-DC-CA,DC=MARVEL,DC=local


[*] Enterprise/Enrollment CAs:

    Enterprise CA Name            : MARVEL-HYDRA-DC-CA
    DNS Hostname                  : HYDRA-DC.MARVEL.local
    FullName                      : HYDRA-DC.MARVEL.local\MARVEL-HYDRA-DC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=MARVEL-HYDRA-DC-CA, DC=MARVEL, DC=local
    Cert Thumbprint               : 692FE10DF2AE748DF58F574181D40FE4D4EF7819
    Cert Serial                   : 43267633E3973CB44EAAE8F936D0A7AE
    Cert Start Date               : 11/21/2023 5:51:22 AM
    Cert End Date                 : 11/21/2122 6:01:22 AM
    Cert Chain                    : CN=MARVEL-HYDRA-DC-CA,DC=MARVEL,DC=local
    UserSpecifiedSAN              : Disabled
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               MARVEL\Domain Admins          S-1-5-21-3246024052-3447002590-2015512265-512
      Allow  ManageCA, ManageCertificates               MARVEL\Enterprise Admins      S-1-5-21-3246024052-3447002590-2015512265-519
    Enrollment Agent Restrictions : None

    Enabled Certificate Templates:
        DirectoryEmailReplication
        DomainControllerAuthentication
        KerberosAuthentication
        EFSRecovery
        EFS
        DomainController
        WebServer
        Machine
        User
        SubCA
        Administrator

Certify completed in 00:00:24.4277020
PS C:\a>
```

## [Find vulnerable/abusable certificate templates using default low-privileged groups](#find-vulnerableabusable-certificate-templates-using-default-low-privileged-groups-1)
Certify.exe find /vulnerable
```sh [+] No Vulnerable Certificates Templates found!
PS C:\a> .\Certify.exe find /vulnerable

   _____          _   _  __
  / ____|        | | (_)/ _|
 | |     ___ _ __| |_ _| |_ _   _
 | |    / _ \ '__| __| |  _| | | |
 | |___|  __/ |  | |_| | | | |_| |
  \_____\___|_|   \__|_|_|  \__, |
                             __/ |
                            |___./
  v1.1.0

[*] Action: Find certificate templates
[*] Using the search base 'CN=Configuration,DC=MARVEL,DC=local'

[*] Listing info about the Enterprise CA 'MARVEL-HYDRA-DC-CA'

    Enterprise CA Name            : MARVEL-HYDRA-DC-CA
    DNS Hostname                  : HYDRA-DC.MARVEL.local
    FullName                      : HYDRA-DC.MARVEL.local\MARVEL-HYDRA-DC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=MARVEL-HYDRA-DC-CA, DC=MARVEL, DC=local
    Cert Thumbprint               : 692FE10DF2AE748DF58F574181D40FE4D4EF7819
    Cert Serial                   : 43267633E3973CB44EAAE8F936D0A7AE
    Cert Start Date               : 11/21/2023 5:51:22 AM
    Cert End Date                 : 11/21/2122 6:01:22 AM
    Cert Chain                    : CN=MARVEL-HYDRA-DC-CA,DC=MARVEL,DC=local
    UserSpecifiedSAN              : Disabled
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               MARVEL\Domain Admins          S-1-5-21-3246024052-3447002590-2015512265-512
      Allow  ManageCA, ManageCertificates               MARVEL\Enterprise Admins      S-1-5-21-3246024052-3447002590-2015512265-519
    Enrollment Agent Restrictions : None

[+] No Vulnerable Certificates Templates found!

Certify completed in 00:00:00.4999981
PS C:\a>
```

```sh [!] Vulnerable Certificates Templates :
lunar\thm@LUNDC C:\Users\thm\a>Certify.exe find /vulnerable

[*] Action: Find certificate templates
[*] Using the search base 'CN=Configuration,DC=lunar,DC=eruca,DC=com' 

[*] Listing info about the Enterprise CA 'lunar-LUNDC-CA'

    Enterprise CA Name            : lunar-LUNDC-CA 
    DNS Hostname                  : LUNDC.lunar.eruca.com 
    FullName                      : LUNDC.lunar.eruca.com\lunar-LUNDC-CA
    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
    Cert SubjectName              : CN=lunar-LUNDC-CA, DC=lunar, DC=eruca, DC=com 
    Cert Thumbprint               : 1801B99A99D23D0CF06A8676A1891FDD0F16C512 
    Cert Serial                   : 77420116D46A6586476B85BD5BF6A237
    Cert Start Date               : 1/14/2022 7:21:18 AM
    Cert End Date                 : 1/14/2027 7:31:16 AM
    Cert Chain                    : CN=lunar-LUNDC-CA,DC=lunar,DC=eruca,DC=com 
    UserSpecifiedSAN              : Disabled 
    CA Permissions                :
      Owner: BUILTIN\Administrators        S-1-5-32-544 

      Access Rights                                     Principal

      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11
      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544
      Allow  ManageCA, ManageCertificates               LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
      Allow  ManageCA, ManageCertificates               LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
    Enrollment Agent Restrictions : None

[!] Vulnerable Certificates Templates :

    CA Name                               : LUNDC.lunar.eruca.com\lunar-LUNDC-CA 
    Template Name                         : UserRequest
    Schema Version                        : 2
    Validity Period                       : 1 year
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT_CHECK_USER_DS_CERTIFICATE
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Secure Email 
    mspki-certificate-application-policy  : Client Authentication, Encrypting File System, Secure Email
    Permissions
      Enrollment Permissions 
        Enrollment Rights           : LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Domain Users            S-1-5-21-3330634377-1326264276-632209373-513
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
                                      NT AUTHORITY\Authenticated UsersS-1-5-11
      Object Control Permissions
        Owner                       : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
        WriteOwner Principals       : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
        WriteDacl Principals        : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
        WriteProperty Principals    : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519

    CA Name                               : LUNDC.lunar.eruca.com\lunar-LUNDC-CA
    Template Name                         : HTTPSWebServer
    Schema Version                        : 2
    Validity Period                       : 2 years
    Renewal Period                        : 6 weeks
    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT
    mspki-enrollment-flag                 : PUBLISH_TO_DS
    Authorized Signatures Required        : 0
    pkiextendedkeyusage                   : Client Authentication
    mspki-certificate-application-policy  : Client Authentication
    Permissions
      Enrollment Permissions
        Enrollment Rights           : LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
                                      NT AUTHORITY\Authenticated UsersS-1-5-11
      Object Control Permissions
        Owner                       : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
        WriteOwner Principals       : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
        WriteDacl Principals        : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519
        WriteProperty Principals    : LUNAR\Administrator           S-1-5-21-3330634377-1326264276-632209373-500
                                      LUNAR\Domain Admins           S-1-5-21-3330634377-1326264276-632209373-512
                                      LUNAR\Enterprise Admins       S-1-5-21-3330634377-1326264276-632209373-519



Certify completed in 00:00:16.4927555
```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

# [References](#references-1)

https://github.com/GhostPack/Certify