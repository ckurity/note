### [Hunt for ACLs](https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse#hunt-for-acls)
```

```

### 
```

```

### Enumerate which users possess GenericAll or AllExtendedRights permission against "svc-alfresco" user:
```sh
(Get-ACL "AD:$((Get-ADUser svc-alfresco).distinguishedName)").access | ? {$_.ActiveDirectoryRights -match "GenericAll|AllExtendedRights"} | select IdentityReference,ActiveDirectoryRights -Unique | ft -W
```

### Example
```sh
*Evil-WinRM* PS C:\Users\svc-alfresco\Documents> (Get-ACL "AD:$((Get-ADUser svc-alfresco).distinguishedName)").access | ? {$_.ActiveDirectoryRights -match "GenericAll|AllExtendedRights"} | select IdentityReference,ActiveDirectoryRights -Unique | ft -W

IdentityReference              ActiveDirectoryRights
-----------------              ---------------------
NT AUTHORITY\SYSTEM                       GenericAll
HTB\Organization Management               GenericAll
HTB\Exchange Trusted Subsystem            GenericAll
```

### abc is a new user added
```sh
(Get-ACL "AD:$((Get-ADUser abc).distinguishedName)").access | ? {$_.ActiveDirectoryRights -match "GenericAll|AllExtendedRights"} | select IdentityReference,ActiveDirectoryRights -Unique | ft -W
```

### Example
```sh
*Evil-WinRM* PS C:\Users\svc-alfresco\Documents> (Get-ACL "AD:$((Get-ADUser abc).distinguishedName)").access | ? {$_.ActiveDirectoryRights -match "GenericAll|AllExtendedRights"} | select IdentityReference,ActiveDirectoryRights -Unique | ft -W

IdentityReference              ActiveDirectoryRights
-----------------              ---------------------
NT AUTHORITY\SYSTEM                       GenericAll
BUILTIN\Account Operators                 GenericAll
HTB\Domain Admins                         GenericAll
HTB\Organization Management               GenericAll
HTB\Exchange Trusted Subsystem            GenericAll
HTB\Enterprise Admins                     GenericAll
```

### 
```

```

### 
```

```

### 
```

```

### 
```

```

### 
```

```

### 
```

```

### 
```

```

### 
```

```