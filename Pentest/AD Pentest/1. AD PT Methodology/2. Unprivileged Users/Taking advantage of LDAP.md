- 
- [References](#references)

-------------------------------------------

## [Enumerate available SMB-shares]
```sh
netexec
cme
smbmap
```

## [Taking advantage of LDAP]
no special privileges needed to bind to LDAP
any valid account can read the entire directory! (by default)

Create very flexible queries using LDAP...
➢ Examples:
```sh
1. Get a list of all domain users that contain *adm* in their account name
2. Get a list of all domain groups that contain *adm*
3. Get a list of all domain joined systems where operating system like *XP* or *2000*
4. Show all groups a user is memberOf
5. Recursively lookup all members of a group
6. Show all user that have a description like *pass* or *pw*
```

## [Get a list of all domain users]
```sh
ldapsearch -LLL -x -H ldap://pwnylabdc01.pwny.lab -D "jar-jar.binks@pwny.lab" -w Welcome2015 -b dc=pwny,dc=lab "(objectClass=user)" sAMAccountName userPrincipalName memberOf
```

## [Get a list of all domain groups]
```sh
ldapsearch -LLL -x -H ldap://pwnylabdc01.pwny.lab -D "jar-jar.binks@pwny.lab" -w Welcome2015 -b dc=pwny,dc=lab "(objectClass=group)" sAMAccountName member memberOf
```

## [Get a list of all domain joined systems]
```sh
ldapsearch -LLL -x -H ldap://pwnylabdc01.pwny.lab -D "jar-jar.binks@pwny.lab" -w Welcome2015 -b dc=pwny,dc=lab "(objectClass=computer)" name dNSHostname operatingSystem operatingSystemVersion lastLogonTimestamp servicePrincipalName
```

## [Recursively lookup all members of a group]
```sh
ldapsearch -LLL -x -H ldap://pwnylabdc01.pwny.lab -D "jar-jar.binks@pwny.lab" -w Welcome2015 -b dc=pwny,dc=lab "(&(objectClass=user)(memberof:1.2.840.113556.1.4.1941:=CN=Domänen-
Admins,CN=Users,DC=PWNY,DC=LAB))" | grep sAMAccountName | cut -d" " -f2
```

## [Show all groups a user is memberOf]
```sh
ldapsearch -LLL -x -H ldap://pwnylabdc01.pwny.lab -D "jar-jar.binks@pwny.lab" -w Welcome2015 -b dc=pwny,dc=lab "(sAMAccountName=darth.vader)" sAMAccountName userPrincipalName memberOf | grep memberOf | cut -d "=" -f2 | cut -d"," -f1
```

## 
```sh

```

## 
```sh

```

## 
```sh

```

# [References](#references-1)

https://adsecurity.org/wp-content/uploads/2016/08/DEFCON24-2016-Metcalf-BeyondTheMCSE-RedTeamingActiveDirectory.pdf