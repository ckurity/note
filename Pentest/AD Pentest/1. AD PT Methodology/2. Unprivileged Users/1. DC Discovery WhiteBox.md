- [Find Domain Name](#find-domain-name-1)
    - [CMD](#cmd)
    - [PowerShell](#powershell)
    - [CMD & PowerShell](#cmd--powershell)
    - [GUI](#gui)
- [Identifying All Domain Names]
- [Find Domain Controllers (DC)](#find-domain-controllers-dc)
    - [LOGONSERVER]
    - [nslookup](#nslookup)
    - [nltest]
    - [Get-ADDomainController]
- [References](#references)

-------------------------------------------

## [Find Domain Name](#find-domain-name-1)
### [CMD](#cmd-1)
```sh
set u
set USERDNSDOMAIN
set USERDOMAIN
echo %userdomain%
```

### [PowerShell](#powershell-1)
```sh
(Get-ADDomain).DNSRoot
# or
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().Name
# or
(Get-WmiObject Win32_ComputerSystem).Domain
# or
Get-ADDomain
```

```sh
PS C:\Users\thm> (Get-ADDomain).DNSRoot
lunar.eruca.com

PS C:\Users\thm> [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().Name
lunar.eruca.com
```

### [CMD & PowerShell](#cmd--powershell-1)
```sh
systeminfo | findstr Domain
```

### [GUI](#gui-1)
```sh
1. Open System Properties: Press Windows + R to open the Run dialog box. Type sysdm.cpl and press Enter.
2. Navigate to Computer Name tab: In the System Properties window, select the Computer Name tab.
3. Check Member of domain: Under the Member of section, you will see the domain name if the computer is joined to a domain.
```

## [Identifying All Domain Names]
```sh
Get-ADForest
Get-ADForest | Select-Object -ExpandProperty Domains
```

```sh
PS C:\Users\thm> Get-ADForest | Select-Object -ExpandProperty Domains
lunar.eruca.com
```

[Find Domain Controllers (DC)](#find-domain-controllers-dc-1)
If you have a domain joined Windows Machine

### [LOGONSERVER]
```sh
C:\>set l
LOCALAPPDATA=C:\Users\pparker\AppData\Local
LOGONSERVER=\\HYDRA-DC

C:\>echo %LOGONSERVER%
\\HYDRA-DC
```

```sh
PS C:\> ls env:l*

Name                           Value
----                           -----
LOCALAPPDATA                   C:\Users\pparker\AppData\Local
LOGONSERVER                    \\HYDRA-DC

PS C:\> $env:LOGONSERVER
\\HYDRA-DC

PS C:\> ping HYDRA-DC -n 1

Pinging HYDRA-DC.MARVEL.local [10.0.2.250] with 32 bytes of data:
Reply from 10.0.2.250: bytes=32 time<1ms TTL=128
```

### [nslookup](#nslookup-1)
```sh
#Finding DC IP
nslookup -querytype=SRV _LDAP._TCP.DC._MSDCS.<domain_name>
nslookup -querytype=SRV _ldap._tcp.dc._msdcs.EXAMPLE.COM

# http://dev.blog.theredteamguy.com/pentesting/internal-pentest-cheat-sheet/#list-domain-controllers-nslookup
nslookup -type=SRV _ldap._tcp.DOMAIN_NAME
nslookup -> set type=all -> _ldap._tcp.dmsdcs.DOMAIN_NAME
nslookup -type=srv _ldap._tcp.dc._msdcs.DOMAIN_NAME
```

https://pswalia2u.medium.com/ad-enumeration-b2303ba8671c

Nslookup should give you a list of all domaincontrollers of `frontoso.com`
https://secattic.blogspot.com/2013/



### [nltest]
```sh
nltest /server:<IP> /dclist:<domain_name>

/DCLIST:<DomainName> - Get list of DC's for <DomainName>
/DCNAME:<DomainName> - Get the PDC name for <DomainName>
```

### [System.DirectoryServices]
```sh
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers
New-Object System.DirectoryServices.DirectoryEntry
```

### [Get-ADDomainController]
```sh
Get-ADDomainController
Get-ADDomainController -Filter * | Select-Object Name, Domain
Get-ADDomainController -Filter * | Select-Object Name, Domain, Enabled, Forest, IPv4Address, OperatingSystem, Site | Format-Table
Get-ADDomainController -Server "DOMAIN-NAME" -Filter * | Select-Object Name, Domain, Enabled, Forest, IPv4Address, OperatingSystem, Site | Format-Table
```

https://br33z3.github.io/rtfm

## 
```sh

```

## 
```sh

```

## 
```sh

```

```sh
Get-Domain | Select-Object -ExpandProperty DomainControllers
```

# [References](#references-1)

https://adsecurity.org/wp-content/uploads/2016/08/DEFCON24-2016-Metcalf-BeyondTheMCSE-RedTeamingActiveDirectory.pdf

https://pswalia2u.medium.com/ad-enumeration-b2303ba8671c

https://www.slideshare.net/hacknpentest/hunt-for-domain-controller-activedirectory-pentesting-operatingSystemVersion

https://gist.github.com/ahmedjavid

https://www.oreilly.com/library/view/active-directory-cookbook/0596004648/ch03s22.html