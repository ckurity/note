


- 
- [References](#references)

-------------------------------------------


```sh
PS C:\Users\user> gsv winrm

Status   Name               DisplayName
------   ----               -----------
Stopped  winrm              Windows Remote Management (WS-Manag...


PS C:\Users\user> gsv winrm | fl


Name                : winrm
DisplayName         : Windows Remote Management (WS-Management)
Status              : Stopped
DependentServices   : {}
ServicesDependedOn  : {RPCSS, HTTP}
CanPauseAndContinue : False
CanShutdown         : False
CanStop             : False
ServiceType         : Win32ShareProcess
```

## [WinRM firewall exception will not work]
```sh
PS C:\Windows\system32> winrm quickconfig
WinRM is not set up to receive requests on this machine.
The following changes must be made:

Set the WinRM service type to delayed auto start.
Start the WinRM service.
Configure LocalAccountTokenFilterPolicy to grant administrative rights remotely to local users.

Make these changes [y/n]? y

WinRM has been updated to receive requests.

WinRM service type changed successfully.
WinRM service started.
Configured LocalAccountTokenFilterPolicy to grant administrative rights remotely to local users.
WSManFault
    Message
        ProviderFault
            WSManFault
                Message = WinRM firewall exception will not work since one of the network connection types on this machi
ne is set to Public. Change the network connection type to either Domain or Private and try again.

Error number:  -2144108183 0x80338169
WinRM firewall exception will not work since one of the network connection types on this machine is set to Public. Chang
e the network connection type to either Domain or Private and try again.
PS C:\Windows\system32>
PS C:\Windows\system32> gsv winrm

Status   Name               DisplayName
------   ----               -----------
Running  winrm              Windows Remote Management (WS-Manag... 👈

PS C:\Windows\system32> netstat -an | findstr 598
PS C:\Windows\system32>
```

## 
```sh
PS C:\Windows\system32> winrm quickconfig
WinRM already is set up to receive requests on this machine.
WinRM is not set up to allow remote access to this machine for management.
The following changes must be made:

Create a WinRM listener on HTTP://* to accept WS-Man requests to any IP on this machine.
Enable the WinRM firewall exception.

Make these changes [y/n]? y

WinRM has been updated for remote management.

Created a WinRM listener on HTTP://* to accept WS-Man requests to any IP on this machine.
WinRM firewall exception enabled.
PS C:\Windows\system32>

PS C:\Windows\system32> gsv winrm

Status   Name               DisplayName
------   ----               -----------
Running  winrm              Windows Remote Management (WS-Manag... 👈


PS C:\Windows\system32>
PS C:\Windows\system32> netstat -an | findstr 598
  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING 👈
  TCP    [::]:5985              [::]:0                 LISTENING 👈
PS C:\Windows\system32>
```

## 
```sh
$ cme winrm $t 
SMB         10.10.54.97     5985   TCM-PC           [*] Windows 6.1 Build 7601 (name:TCM-PC) (domain:TCM-PC)
HTTP        10.10.54.97     5985   TCM-PC           [*] http://10.10.54.97:5985/wsman
```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

## 
```sh

```

# [References](#references-1)



https://stackoverflow.com/questions/16010091/connecting-to-remote-server-failed-using-winrm-from-powershell

PS C:\> winrm get winrm/config/client
Client
    NetworkDelayms = 5000
    URLPrefix = wsman
    AllowUnencrypted = false
    Auth
        Basic = true
        Digest = true
        Kerberos = true
        Negotiate = true
        Certificate = true
        CredSSP = false
    DefaultPorts
        HTTP = 5985
        HTTPS = 5986
    TrustedHosts

PS C:\>
PS C:\> winrm set winrm/config/client @{TrustedHosts="10.10.10.161"}
Error: Invalid use of command line. Type "winrm -?" for help.
PS C:\>
PS C:\> winrm get winrm/config/client
Client
    NetworkDelayms = 5000
    URLPrefix = wsman
    AllowUnencrypted = false
    Auth
        Basic = true
        Digest = true
        Kerberos = true
        Negotiate = true
        Certificate = true
        CredSSP = false
    DefaultPorts
        HTTP = 5985
        HTTPS = 5986
    TrustedHosts

PS C:\>



PS C:\> Set-Item wsman:localhost\client\trustedhosts -value 10.10.10.161

WinRM Security Configuration.
This command modifies the TrustedHosts list for the WinRM client. The computers in the TrustedHosts list might not be authenticated. The client might send credential
information to these computers. Are you sure that you want to modify this list?
[Y] Yes  [N] No  [S] Suspend  [?] Help (default is "Y"):
PS C:\>
PS C:\>
PS C:\> winrm get winrm/config/client
Client
    NetworkDelayms = 5000
    URLPrefix = wsman
    AllowUnencrypted = false
    Auth
        Basic = true
        Digest = true
        Kerberos = true
        Negotiate = true
        Certificate = true
        CredSSP = false
    DefaultPorts
        HTTP = 5985
        HTTPS = 5986
    TrustedHosts = 10.10.10.161

PS C:\>



PS C:\> Enter-PSSession 10.10.10.161 -Credential svc-alfresco
[10.10.10.161]: PS C:\Users\svc-alfresco\Documents> ls


    Directory: C:\Users\svc-alfresco\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        31/7/2023   9:51 AM            335 20230730231336_BloodHound.zip
-a----        30/7/2023   7:21 PM         770279 PowerView.ps1
-a----        30/7/2023  10:18 PM        1046528 SharpHound.exe
-a----        30/7/2023  10:19 PM        1308348 SharpHound.ps1


[10.10.10.161]: PS C:\Users\svc-alfresco\Documents>